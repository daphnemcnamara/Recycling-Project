<!DOCTYPE html>
<html>
<head>
    <title>Image recognition</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/ml5@0.4.3/dist/ml5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/webcamjs/1.0.26/webcam.js"></script>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-md-8">
            <center>
                <h1 class="btn btn-default-heading" style="margin-bottom: 22px; font-size: 36px;"><strong>Ein bilderkennungsgesteuertes Recycling-Trennungsprojekt von Daphne McNamara</strong></h1>
                <p style="font-size: 24px;">Mit KI und maschinellem Lernen verbessert mein Projekt die MÃ¼llsortierung...</p>
                <br>
                <div id="webcam" style="width: 640px; height: 480px;"></div>
                <br>
                <input type="file" id="file-input" accept="image/*">
                <button class="btn btn-info" style="font-size: 28px; padding: 10px 20px;" onclick="loadImage()">Bild Hochladen</button>
                <button class="btn btn-primary" style="font-size: 28px; padding: 10px 20px;" onclick="takeSnapshot()">Foto Aufnehmen</button>
                <button class="btn btn-success" style="font-size: 28px; padding: 10px 20px;" onclick="identify()">Identifizieren</button>
                <div id="result"></div>
                <p style="font-size: 36px;">Objekt: <span id="object_name"></span></p>
                <p style="font-size: 36px;">Genauigkeit: <span id="accuracy_count"></span></p>
            </center>
        </div>
    </div>
</div>
<script>
    let currentImage = null;  // This will hold the current image data URL
    let classifier;  // This will be our classifier

    // Load the classifier
    ml5.imageClassifier('https://teachablemachine.withgoogle.com/models/model_URL/model.json', modelLoaded)
        .then(model => {
            classifier = model;
        });

    function modelLoaded() {
        console.log('Model loaded successfully');
    }

    Webcam.set({
        width: 640,
        height: 480,
        image_format: 'jpeg',
        jpeg_quality: 90
    });
    Webcam.attach('#webcam');

    function takeSnapshot() {
        Webcam.snap(function(data_uri) {
            currentImage = data_uri; // Store the image data URL
        });
    }

    function loadImage() {
        var fileInput = document.getElementById('file-input');
        var file = fileInput.files[0];
        var reader = new FileReader();
        reader.onload = function(e) {
            currentImage = e.target.result; // Store the image data URL
        };
        reader.readAsDataURL(file);
    }

    function identify() {
        if (currentImage && classifier) {
            classifier.classify({image: currentImage}, function(error, results) {
                if (error) {
                    console.error(error);
                } else {
                    document.getElementById('object_name').textContent = 'Objekt: ' + results[0].label;
                    document.getElementById('accuracy_count').textContent = 'Genauigkeit: ' + (results[0].confidence * 100).toFixed(2) + '%';
                    document.getElementById('result').innerHTML = '<img src="' + currentImage + '"/>'; // Display the image
                }
            });
        }
    }
</script>
</body>
</html>
